init = [1.5e-4;0.0;1.0;0.0;0.0;0.0;0.0;0.0];
t = linspace(0.0,40.0,40);
function xdot = f(x,t) 

xdot(1) = x(6) .+ x(7) .+ x(8) .+ -1.0.*x(4).*x(1) .+ -1.0.*x(2).*x(1) .+ -1.0.*x(3).*x(1);
xdot(2) = x(6) .+ -1.0.*x(2).*x(1);
xdot(3) = -1.0.*x(3).*x(1);
xdot(4) = -1.0.*x(4).*x(1);
xdot(5) = x(7) .+ x(8);
xdot(6) = -1.0.*x(6) .+ x(3).*x(1);
xdot(7) = -1.0.*x(7) .+ x(2).*x(1);
xdot(8) = -1.0.*x(8) .+ x(4).*x(1);
endfunction;

function jac = jj(x,t)

jac(1,1) = -1.0.*x(4) .+ -1.0.*x(2) .+ -1.0.*x(3);
jac(1,2) = -1.0.*x(1);
jac(1,3) = -1.0.*x(1);
jac(1,4) = -1.0.*x(1);
jac(1,5) = 0.0;
jac(1,6) = 1.0;
jac(1,7) = 1.0;
jac(1,8) = 1.0;
jac(2,1) = -1.0.*x(2);
jac(2,2) = -1.0.*x(1);
jac(2,3) = 0.0;
jac(2,4) = 0.0;
jac(2,5) = 0.0;
jac(2,6) = 1.0;
jac(2,7) = 0.0;
jac(2,8) = 0.0;
jac(3,1) = -1.0.*x(3);
jac(3,2) = 0.0;
jac(3,3) = -1.0.*x(1);
jac(3,4) = 0.0;
jac(3,5) = 0.0;
jac(3,6) = 0.0;
jac(3,7) = 0.0;
jac(3,8) = 0.0;
jac(4,1) = -1.0.*x(4);
jac(4,2) = 0.0;
jac(4,3) = 0.0;
jac(4,4) = -1.0.*x(1);
jac(4,5) = 0.0;
jac(4,6) = 0.0;
jac(4,7) = 0.0;
jac(4,8) = 0.0;
jac(5,1) = 0.0;
jac(5,2) = 0.0;
jac(5,3) = 0.0;
jac(5,4) = 0.0;
jac(5,5) = 0.0;
jac(5,6) = 0.0;
jac(5,7) = 1.0;
jac(5,8) = 1.0;
jac(6,1) = x(3);
jac(6,2) = 0.0;
jac(6,3) = x(1);
jac(6,4) = 0.0;
jac(6,5) = 0.0;
jac(6,6) = -1.0;
jac(6,7) = 0.0;
jac(6,8) = 0.0;
jac(7,1) = x(2);
jac(7,2) = x(1);
jac(7,3) = 0.0;
jac(7,4) = 0.0;
jac(7,5) = 0.0;
jac(7,6) = 0.0;
jac(7,7) = -1.0;
jac(7,8) = 0.0;
jac(8,1) = x(4);
jac(8,2) = 0.0;
jac(8,3) = 0.0;
jac(8,4) = x(1);
jac(8,5) = 0.0;
jac(8,6) = 0.0;
jac(8,7) = 0.0;
jac(8,8) = -1.0;
endfunction;

x = lsode({@f,@jj}, init, t);
save ("-ascii", "-", "x");